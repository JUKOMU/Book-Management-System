{% extends "base-admin.html" %}
{% block title %}查询图书信息{% endblock %}

{% block card %}
<div class="layui-card-header"><h2>发布公告</h2></div>{% endblock %}
{% block body %}
<form class="layui-form" method="post" id="searchForm" enctype="multipart/form-data">
    {{ form.csrf_token }}
    <div class="layui-form-item">
        <div class="layui-inline">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md6">
                    <label class="layui-form-label">公告标题：</label>
                    <div class="layui-input-inline">
                        {{ form.title(class="layui-input",style="width:250px") }}
                    </div>
                </div>
                <div class="layui-col-md4">
                    {{ form.file(class="layui-input-block", accept=".md,.txt") }}
                </div>
                <div class="layui-col-md2">
                    <div class="layui-input-inline">{{ form.submit(class="layui-btn", id="post") }}</div>
                </div>
            </div>
        </div>

    </div>
</form>

{% endblock %}

{% block script %}
<script>
    $(document).ready(function () {
        $("#li_5").addClass("height-light");
        $('#post').on('click', function () {
            var form = new FormData(document.getElementById("searchForm"));
            $.ajax({
                url: "{{ url_for('post_announcement') }}",
                type: "post",
                data: form,
                processData: false,
                contentType: false,
                success: function (data) {
                    if (data.length !== 0) {
                        window.location.replace()
                    } else {
                        layui.use('layer', function () {
                            var layer = layui.layer;
                            layer.msg('发布失败', {time: 1000});
                        });
                    }
                }
            });
            return false;
        })
    });
</script>
{% endblock %}

